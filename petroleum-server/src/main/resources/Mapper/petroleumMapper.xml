<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.petroleumserver.mapper.petroleumMapper">

<!--excel-->
    <insert id="addJinShenByList" parameterType="java.util.List">
        insert into jingshen (WellName, company, PrimaryWellType, WellType, WellSection, HoleDiameter, StartTime, EndTime, StartDepth, StartVerticalDepth, EndDepth, EndVerticalDepth, CasingDiameter, SteelGrade, CasingSetDepth, CasingLength, CementReturnHeight, UpperCasingDiameter, UpperCasingSetDepth, DrillingFluidSystem, DrillingFluidDensity, PlasticViscosity, YieldValue, FormationPressure, status)
        values
        <foreach collection="jingshenss" item="item" separator="),(" open="(" close=")">
            #{item.WellName},
            #{item.company},
            #{item.PrimaryWellType},
            #{item.WellType},
            #{item.WellSection},
            #{item.HoleDiameter},
            #{item.StartTime},
            #{item.EndTime},
            #{item.StartDepth},
            #{item.StartVerticalDepth},
            #{item.EndDepth},
            #{item.EndVerticalDepth},
            #{item.CasingDiameter},
            #{item.SteelGrade},
            #{item.CasingSetDepth},
            #{item.CasingLength},
            #{item.CementReturnHeight},
            #{item.UpperCasingDiameter},
            #{item.UpperCasingSetDepth},
            #{item.DrillingFluidSystem},
            #{item.DrillingFluidDensity},
            #{item.PlasticViscosity},
            #{item.YieldValue},
            #{item.FormationPressure},
            #{item.status}
        </foreach>
    </insert>
    <insert id="addJiBenByList" parameterType="com.petroleumpojo.entity.JiBen">
        insert into jibenxinxi
        (wellName, company, oilFieldName, oilFieldCode, isCooperative, contractor, primaryWellType, secondaryWellType, tertiaryWellType, wellType, waterDepth1, designDepth, designVerticalDepth, designDate, structureName, uniqueWellId, chineseWellName, operator, hydrocarbonType, riskLevel, riskType, riskGrade, sulfurGrade, containsCO2, zeroDepth, initialKellyElevation, groundElevation, currentKellyElevation, casingHeadElevation, waterDepth2, mudLineElevation, artificialBottomDepth, drillingDays, positioningMethod, location, geodeticSystem, longitude, latitude, xcoordinate, ycoordinate, slotNumber, country, region, province, county, scrapedWell, officePhone, remark, status)
        values
        <foreach collection="jiBen" item="item" separator="),(" open="(" close=")">
            #{item.wellName},
            #{item.company},
            #{item.oilFieldName},
            #{item.oilFieldCode},
            #{item.isCooperative},
            #{item.contractor},
            #{item.primaryWellType},
            #{item.secondaryWellType},
            #{item.tertiaryWellType},
            #{item.wellType},
            #{item.waterDepth1},
            #{item.designDepth},
            #{item.designVerticalDepth},
            #{item.designDate},
            #{item.structureName},
            #{item.uniqueWellId},
            #{item.chineseWellName},
            #{item.operator},
            #{item.hydrocarbonType},
            #{item.riskLevel},
            #{item.riskType},
            #{item.riskGrade},
            #{item.sulfurGrade},
            #{item.containsCO2},
            #{item.zeroDepth},
            #{item.initialKellyElevation},
            #{item.groundElevation},
            #{item.currentKellyElevation},
            #{item.casingHeadElevation},
            #{item.waterDepth2},
            #{item.mudLineElevation},
            #{item.artificialBottomDepth},
            #{item.drillingDays},
            #{item.positioningMethod},
            #{item.location},
            #{item.geodeticSystem},
            #{item.longitude},
            #{item.latitude},
            #{item.xcoordinate},
            #{item.ycoordinate},
            #{item.slotNumber},
            #{item.country},
            #{item.region},
            #{item.province},
            #{item.county},
            #{item.scrapedWell},
            #{item.officePhone},
            #{item.remark},
            #{item.status}
        </foreach>
    </insert>
    <insert id="addFuZaByList" parameterType="com.petroleumpojo.entity.FuZa">
        insert into fuza
        (wellName, company, primaryWellType, wellType, startTime, endTime, durationHours, firstLevelCode, secondLevelCode, thirdLevelCode, fourthLevelCode, complexityType, wellSection, startDepth, endDepth, operationDescription, status)
        values
        <foreach collection="fuza" item="item" separator="),(" open="(" close=")">
            #{item.wellName},
            #{item.company},
            #{item.primaryWellType},
            #{item.wellType},
            #{item.startTime},
            #{item.endTime},
            #{item.durationHours},
            #{item.firstLevelCode},
            #{item.secondLevelCode},
            #{item.thirdLevelCode},
            #{item.fourthLevelCode},
            #{item.complexityType},
            #{item.wellSection},
            #{item.startDepth},
            #{item.endDepth},
            #{item.operationDescription},
            #{item.status}
        </foreach>
    </insert>
    <insert id="addZuanTouByList" parameterType="com.petroleumpojo.entity.ZuanTou">
        insert into zuantou
        (wellName, company, primaryWellType, wellType, drillBitNumber, drillBitType, sizeIn, manufacturer, model, serialNumber, nozzleSize, drillBitTFAn2, entryDepth, exitDepth, entryTime, exitTime, advanceDistance, pureDrillingTime, rop, maxDrillingPressure, minDrillingPressure, maxRotationSpeed, minRotationSpeed, iadcWearEvaluation, encounteredFormation, status)
        values
        <foreach collection="zuantou" item="item" separator="),(" open="(" close=")">
            #{item.wellName},
            #{item.company},
            #{item.primaryWellType},
            #{item.wellType},
            #{item.drillBitNumber},
            #{item.drillBitType},
            #{item.sizeIn},
            #{item.manufacturer},
            #{item.model},
            #{item.serialNumber},
            #{item.nozzleSize},
            #{item.drillBitTFAn2},
            #{item.entryDepth},
            #{item.exitDepth},
            #{item.entryTime},
            #{item.exitTime},
            #{item.advanceDistance},
            #{item.pureDrillingTime},
            #{item.rop},
            #{item.maxDrillingPressure},
            #{item.minDrillingPressure},
            #{item.maxRotationSpeed},
            #{item.minRotationSpeed},
            #{item.iadcWearEvaluation},
            #{item.encounteredFormation},
            #{item.status}
        </foreach>
    </insert>
<!--单独新增-->
    <insert id="addJS" parameterType="com.petroleumpojo.entity.JingShen">
        insert into jingshen (WellName, company, PrimaryWellType, WellType, WellSection, HoleDiameter, StartTime, EndTime, StartDepth, StartVerticalDepth, EndDepth, EndVerticalDepth, CasingDiameter, SteelGrade, CasingSetDepth, CasingLength, CementReturnHeight, UpperCasingDiameter, UpperCasingSetDepth, DrillingFluidSystem, DrillingFluidDensity, PlasticViscosity, YieldValue, FormationPressure, status)
        values
        <foreach collection="jingShen" item="item" separator="),(" open="(" close=")">
            #{item.wellName},
            #{item.company},
            #{item.primaryWellType},
            #{item.wellType},
            #{item.wellSection},
            #{item.holeDiameter},
            #{item.startTime},
            #{item.endTime},
            #{item.startDepth},
            #{item.startVerticalDepth},
            #{item.endDepth},
            #{item.endVerticalDepth},
            #{item.casingDiameter},
            #{item.steelGrade},
            #{item.casingSetDepth},
            #{item.casingLength},
            #{item.cementReturnHeight},
            #{item.upperCasingDiameter},
            #{item.upperCasingSetDepth},
            #{item.drillingFluidSystem},
            #{item.drillingFluidDensity},
            #{item.plasticViscosity},
            #{item.yieldValue},
            #{item.formationPressure},
            #{item.status}
        </foreach>
    </insert>
    <insert id="addJB">
        insert into jibenxinxi (wellName, company, oilFieldName, oilFieldCode, isCooperative, contractor, primaryWellType, secondaryWellType, tertiaryWellType, wellType, waterDepth1, designDepth, designVerticalDepth, designDate, structureName, uniqueWellId, chineseWellName, operator, hydrocarbonType, riskLevel, riskType, riskGrade, sulfurGrade, containsCO2, zeroDepth, initialKellyElevation, groundElevation, currentKellyElevation, casingHeadElevation, waterDepth2, mudLineElevation, artificialBottomDepth, drillingDays, positioningMethod, location, geodeticSystem, longitude, latitude, xcoordinate, ycoordinate, slotNumber, country, region, province, county, scrapedWell, officePhone, remark,  status)
        values
        <foreach collection="jiBen" item="item" separator="),(" open="(" close=")">
                #{item.wellName},
                #{item.company},
                #{item.oilFieldName},
                #{item.oilFieldCode},
                #{item.isCooperative},
                #{item.contractor},
                #{item.primaryWellType},
                #{item.secondaryWellType},
                #{item.tertiaryWellType},
                #{item.wellType},
                #{item.waterDepth1},
                #{item.designDepth},
                #{item.designVerticalDepth},
                #{item.designDate},
                #{item.structureName},
                #{item.uniqueWellId},
                #{item.chineseWellName},
                #{item.operator},
                #{item.hydrocarbonType},
                #{item.riskLevel},
                #{item.riskType},
                #{item.riskGrade},
                #{item.sulfurGrade},
                #{item.containsCO2},
                #{item.zeroDepth},
                #{item.initialKellyElevation},
                #{item.groundElevation},
                #{item.currentKellyElevation},
                #{item.casingHeadElevation},
                #{item.waterDepth2},
                #{item.mudLineElevation},
                #{item.artificialBottomDepth},
                #{item.drillingDays},
                #{item.positioningMethod},
                #{item.location},
                #{item.geodeticSystem},
                #{item.longitude},
                #{item.latitude},
                #{item.xcoordinate},
                #{item.ycoordinate},
                #{item.slotNumber},
                #{item.country},
                #{item.region},
                #{item.province},
                #{item.county},
                #{item.scrapedWell},
                #{item.officePhone},
                #{item.remark},
                #{item.status}
        </foreach>
    </insert>
    <insert id="addFZ">
        insert into fuza (wellName, company, primaryWellType, wellType, startTime, endTime, durationHours, firstLevelCode, secondLevelCode, thirdLevelCode, fourthLevelCode, complexityType, wellSection, startDepth, endDepth, operationDescription, status)
        values
        <foreach collection="fuza" item="item" separator="),(" open="(" close=")">
            #{item.wellName}, #{item.company}, #{item.primaryWellType}, #{item.wellType}, #{item.startTime}, #{item.endTime}, #{item.durationHours}, #{item.firstLevelCode}, #{item.secondLevelCode}, #{item.thirdLevelCode}, #{item.fourthLevelCode}, #{item.complexityType}, #{item.wellSection}, #{item.startDepth}, #{item.endDepth}, #{item.operationDescription}, #{item.status}
        </foreach>
    </insert>
    <insert id="addZT">
        insert into zuantou (wellName, company, primaryWellType, wellType, drillBitNumber, drillBitType, sizeIn, manufacturer, model, serialNumber, nozzleSize, drillBitTFAn2, entryDepth, exitDepth, entryTime, exitTime, advanceDistance, pureDrillingTime, rop, maxDrillingPressure, minDrillingPressure, maxRotationSpeed, minRotationSpeed, iadcWearEvaluation, encounteredFormation, status)
        values
        <foreach collection="zuantou" item="item" separator="),(" open="(" close=")">
            #{item.wellName}, #{item.company}, #{item.primaryWellType}, #{item.wellType}, #{item.drillBitNumber}, #{item.drillBitType}, #{item.sizeIn}, #{item.manufacturer}, #{item.model}, #{item.serialNumber}, #{item.nozzleSize}, #{item.drillBitTFAn2}, #{item.entryDepth}, #{item.exitDepth}, #{item.entryTime}, #{item.exitTime}, #{item.advanceDistance}, #{item.pureDrillingTime}, #{item.rop}, #{item.maxDrillingPressure}, #{item.minDrillingPressure}, #{item.maxRotationSpeed}, #{item.minRotationSpeed}, #{item.iadcWearEvaluation}, #{item.encounteredFormation}, #{item.status}
        </foreach>
    </insert>
<!--搜索-->
    <select id="searchjs" resultType="com.petroleumpojo.entity.JingShen">
        select * from jingshen where WellName like '%${WellName}%'
                                 and PrimaryWellType like '%${PrimaryWellType}%'
                                 and WellType like '%${WellType}%'
                                 and status = 1
        order by StartTime desc
    </select>
    <select id="searchjb" resultType="com.petroleumpojo.entity.JiBen">
        select * from jibenxinxi where wellName like '%${wellName}%'
                                 and oilFieldName like '%${oilFieldName}%'
                                 and contractor like '%${contractor}%'
                                 and status = 1
        order by wellName desc
    </select>
    <select id="searchfz" resultType="com.petroleumpojo.entity.FuZa">
        select * from fuza where wellName like '%${wellName}%'
                                 and primaryWellType like '%${primaryWellType}%'
                                 and wellType like '%${wellType}%'
                                 and status = 1
        order by StartTime desc
    </select>
    <select id="searchzt" resultType="com.petroleumpojo.entity.ZuanTou">
        select * from zuantou where wellName like '%${wellName}%'
                             and primaryWellType like '%${primaryWellType}%'
                             and wellType like '%${wellType}%'
                             and status = 1
        order by entryTime desc
    </select>
<!--软删除-->
    <update id="updateStatusJS">
        update jingshen set status = 0 where OnlyKey = #{OnlyKey}
    </update>
    <update id="updateStatusJB">
        update jibenxinxi set status = 0
        WHERE OnlyKey = #{OnlyKey} AND status = 1
#             wellName = #{wellName} AND
#             company = #{company} AND
#             oilFieldName = #{oilFieldName} AND
#             oilFieldCode = #{oilFieldCode} AND
#             isCooperative = #{isCooperative} AND
#             contractor = #{contractor} AND
#             primaryWellType = #{primaryWellType} AND
#             secondaryWellType = #{secondaryWellType} AND
#             tertiaryWellType = #{tertiaryWellType} AND
#             wellType = #{wellType} AND
#             waterDepth1 = #{waterDepth1} AND
#             designDepth = #{designDepth} AND
#             designVerticalDepth = #{designVerticalDepth} AND
#             designDate = #{designDate} AND
#             structureName = #{structureName} AND
#             uniqueWellId = #{uniqueWellId} AND
#             chineseWellName = #{chineseWellName} AND
#             operator = #{operator} AND
#             hydrocarbonType = #{hydrocarbonType} AND
#             riskLevel = #{riskLevel} AND
#             riskType = #{riskType} AND
#             riskGrade = #{riskGrade} AND
#             sulfurGrade = #{sulfurGrade} AND
#             containsCO2 = #{containsCO2} AND
#             zeroDepth = #{zeroDepth} AND
#             initialKellyElevation = #{initialKellyElevation} AND
#             groundElevation = #{groundElevation} AND
#             currentKellyElevation = #{currentKellyElevation} AND
#             casingHeadElevation = #{casingHeadElevation} AND
#             waterDepth2 = #{waterDepth2} AND
#             mudLineElevation = #{mudLineElevation} AND
#             artificialBottomDepth = #{artificialBottomDepth} AND
#             drillingDays = #{drillingDays} AND
#             positioningMethod = #{positioningMethod} AND
#             location = #{location} AND
#             geodeticSystem = #{geodeticSystem} AND
#             longitude = #{longitude} AND
#             latitude = #{latitude} AND
#             xcoordinate = #{xcoordinate} AND
#             ycoordinate = #{ycoordinate} AND
#             slotNumber = #{slotNumber} AND
#             country = #{country} AND
#             region = #{region} AND
#             province = #{province} AND
#             county = #{county} AND
#             scrapedWell = #{scrapedWell} AND
#             officePhone = #{officePhone} AND
#             remark = #{remark}
#             status = 1
    </update>
    <update id="updateStatusFZ">
        update fuza set status = 0
        where OnlyKey = #{OnlyKey} AND status = 1
#             wellName = #{wellName} AND
#             company = #{company} AND
#             primaryWellType = #{primaryWellType} AND
#             wellType = #{wellType} AND
#             startTime = IFNULL(#{startTime}, NULL) AND
#             endTime = IFNULL(#{endTime}, NULL) AND
#             durationHours = #{durationHours} AND
#             firstLevelCode = #{firstLevelCode} AND
#             secondLevelCode = #{secondLevelCode} AND
#             thirdLevelCode = #{thirdLevelCode} AND
#             fourthLevelCode = #{fourthLevelCode} AND
#             complexityType = #{complexityType} AND
#             wellSection = #{wellSection} AND
#             startDepth = #{startDepth} AND
#             endDepth = #{endDepth} AND
#             operationDescription = #{operationDescription}
#             status = 1
    </update>
    <update id="updateStatusZT">
        update zuantou set status = 0
        where OnlyKey = #{OnlyKey} AND status = 1
#             wellName = #{wellName} AND
#             company = #{company} AND
#             primaryWellType = #{primaryWellType} AND
#             wellType = #{wellType} AND
#             drillBitNumber = #{drillBitNumber} AND
#             drillBitType = #{drillBitType} AND
#             sizeIn = #{sizeIn} AND
#             manufacturer = #{manufacturer} AND
#             model = #{model} AND
#             serialNumber = #{serialNumber} AND
#             nozzleSize = #{nozzleSize} AND
#             drillBitTFAn2 = #{drillBitTFAn2} AND
#             entryDepth = #{entryDepth} AND
#             exitDepth = #{exitDepth} AND
#             entryTime = #{entryTime} AND
#             exitTime = #{exitTime} AND
#             advanceDistance = #{advanceDistance} AND
#             pureDrillingTime = #{pureDrillingTime} AND
#             rop = #{rop} AND
#             maxDrillingPressure = #{maxDrillingPressure} AND
#             minDrillingPressure = #{minDrillingPressure} AND
#             maxRotationSpeed = #{maxRotationSpeed} AND
#             minRotationSpeed = #{minRotationSpeed} AND
#             iadcWearEvaluation = #{iadcWearEvaluation} AND
#             encounteredFormation = #{encounteredFormation}
    </update>

<!--更新-->
    <update id="updateJS" parameterType="com.petroleumpojo.dto.JingShenDTO">
        update jingshen
        <set>
            <if test="WellName != null">
                WellName = #{WellName},
            </if>
            <if test="company != null">
                company = #{company},
            </if>
            <if test="PrimaryWellType != null">
                PrimaryWellType = #{PrimaryWellType},
            </if>
            <if test="WellType != null">
                WellType = #{WellType},
            </if>
            <if test="WellSection != null">
                WellSection = #{WellSection},
            </if>
            <if test="HoleDiameter != null">
                HoleDiameter = #{HoleDiameter},
            </if>
            <if test="StartTime != null">
                StartTime = #{StartTime},
            </if>
            <if test="EndTime != null">
                EndTime = #{EndTime},
            </if>
            <if test="StartDepth != null">
                StartDepth = #{StartDepth},
            </if>
            <if test="StartVerticalDepth != null">
                StartVerticalDepth = #{StartVerticalDepth},
            </if>
            <if test="EndDepth != null">
                EndDepth = #{EndDepth},
            </if>
            <if test="EndVerticalDepth != null">
                EndVerticalDepth = #{EndVerticalDepth},
            </if>
            <if test="CasingDiameter != null">
                CasingDiameter = #{CasingDiameter},
            </if>
            <if test="SteelGrade != null">
                SteelGrade = #{SteelGrade},
            </if>
            <if test="CasingSetDepth != null">
                CasingSetDepth = #{CasingSetDepth},
            </if>
            <if test="CasingLength != null">
                CasingLength = #{CasingLength},
            </if>
            <if test="CementReturnHeight != null">
                CementReturnHeight = #{CementReturnHeight},
            </if>
            <if test="UpperCasingDiameter != null">
                UpperCasingDiameter = #{UpperCasingDiameter},
            </if>
            <if test="UpperCasingSetDepth != null">
                UpperCasingSetDepth = #{UpperCasingSetDepth},
            </if>
            <if test="DrillingFluidSystem != null">
                DrillingFluidSystem = #{DrillingFluidSystem},
            </if>
            <if test="DrillingFluidDensity != null">
                DrillingFluidDensity = #{DrillingFluidDensity},
            </if>
            <if test="PlasticViscosity != null">
                PlasticViscosity = #{PlasticViscosity},
            </if>
            <if test="YieldValue != null">
                YieldValue = #{YieldValue},
            </if>
            <if test="FormationPressure != null">
                FormationPressure = #{FormationPressure}
            </if>
        </set>
        where OnlyKey = #{OnlyKey}
    </update>

</mapper>
